wandb: WARNING Config item 'seed' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'optimizer' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'model' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'data' was locked by 'sweep' (ignored update).
  0%|          | 0/100001 [00:00<?, ?it/s]
  0%|          | 0/1000 [00:00<?, ?it/s]
CONFIG
├── seed
│   └── 2059
├── seed_eval
│   └── 2000
├── seed_test
│   └── 3000
├── device
│   └── cuda
├── train
│   └── do: true
│       do_save: false
│       reset_every: null
│       dtype: float32
│       compile: false
│       do_amp: false
│       batch_size: 128
│       grad_clip: 1.0
│       iters: 100001
│       samples: null
│       log_every: 1000
│       save_every: 100000
│       save_path: ./out
│       num_workers: 0
│       do_early_stop: false
│       early_stop_patience: 5
│       early_stop_metric: loss
│       early_stop_tol: 0.001
│       early_stop_start_iter: 20000.2
│       early_stop_acc: null
│       parallel_loss: true
│       merge_embeds: false
│       merge_type: sum
│
├── eval
│   └── do: true
│       split: both
│       batch_size: 1
│       every: 5000
│       every_samples: null
│       iters: 1000
│
├── scheduler
│   └── decay_lr: true
│       warmup_iters: 20000.2
│       lr_decay_iters: 100001
│       min_lr: 0.0001
│
├── optimizer
│   └── lr: 0.001
│       _name_: adamw
│       weight_decay: 0
│       betas:
│       - 0.9
│       - 0.95
│
├── log_level
│   └── info
├── examples_to_log
│   └── 3
├── log_batch_idx
│   └── [0, 1]
├── wandb
│   └── project: icl-arch
│
├── save_checkpoints
│   └── False
├── nl_icl
│   └── do: false
│       checkpoint_path: null
│       hf_path: null
│       task: sentiment
│       n_seeds: 10
│       min_examples_per_class: 0
│       max_examples_per_class: 9
│       do_full_vocab: true
│
├── do_count_param_only
│   └── False
├── model
│   └── _name_: rnn
│       d_model: 64
│       n_layer: 12
│       activ_fn: tanh
│       bias: false
│       batch_first: true
│       dropout: 0.0
│       bidirectional: false
│       max_seq_len: 4096
│
└── data
    └── _name_: gauss-mix-model
        num_classes: 2
        num_xy_pairs_train: 32
        num_xy_pairs_val: 1024
        dim: 16
head.linear.weight: 128
head.linear.bias: 2
rnn.weight_ih_l0: 4096
rnn.weight_hh_l0: 4096
rnn.weight_ih_l1: 4096
rnn.weight_hh_l1: 4096
rnn.weight_ih_l2: 4096
rnn.weight_hh_l2: 4096
rnn.weight_ih_l3: 4096
rnn.weight_hh_l3: 4096
rnn.weight_ih_l4: 4096
rnn.weight_hh_l4: 4096
rnn.weight_ih_l5: 4096
rnn.weight_hh_l5: 4096
rnn.weight_ih_l6: 4096
rnn.weight_hh_l6: 4096
rnn.weight_ih_l7: 4096
rnn.weight_hh_l7: 4096
rnn.weight_ih_l8: 4096
rnn.weight_hh_l8: 4096
rnn.weight_ih_l9: 4096
rnn.weight_hh_l9: 4096
rnn.weight_ih_l10: 4096
rnn.weight_hh_l10: 4096
rnn.weight_ih_l11: 4096
rnn.weight_hh_l11: 4096
n_params=98434
ignored=[('embedder.embedder.weight', 1024), ('embedder.embedder.bias', 64), ('embedder.y_embedder.weight', 32)]
[[split=train]] train_iter: 0, batch_idx: 0, input: [[-1.5143520832061768, 1.7547247409820557, 0.09696385264396667, -1.2768162488937378, -0.04301077127456665, 0.36145925521850586, 0.3306042551994324, -1.5219900608062744, 1.3302793502807617, -0.46433794498443604, 0.6675390601158142, 0.21871596574783325, -1.5362563133239746, -0.8872127532958984, 1.5057337284088135, 1.8132071495056152], [-1.6007181406021118, -0.4788353443145752, 0.028184544295072556, -0.3686429262161255, 0.42227551341056824, -1.725391149520874, 0.3964702785015106, -0.2967173457145691, -0.16716866195201874, 1.344051480293274, -0.18993142247200012, 0.35925912857055664, 1.2835932970046997, -0.7802431583404541, 0.13172271847724915, -0.09341850876808167], [-0.35537034273147583, -0.1103639006614685, 0.33140987157821655, -0.02055203914642334, -0.04400321841239929, -1.6546485424041748, 2.5007529258728027, 0.07875090837478638, 0.10718464851379395, -1.8070284128189087, -1.1343684196472168, -0.4570884108543396, 0.8277196884155273, 0.9047274589538574, 3.121223211288452, 0.16567355394363403], [-0.8045891523361206, -0.8511910438537598, 0.6067851781845093, -0.5601234436035156, 1.332539677619934, 0.1546824872493744, 0.43413957953453064, -0.8006095290184021, -1.2939538955688477, -0.4800732433795929, -1.2939326763153076, -0.25739020109176636, -0.4092409312725067, -0.11367404460906982, 2.330000877380371, 0.20296554267406464], [-1.0687131881713867, 0.706230640411377, -1.0980255603790283, -0.13915877044200897, 1.3317065238952637, -1.7027397155761719, 0.510585367679596, -1.5370551347732544, 1.2595176696777344, -0.5114614963531494, -0.5539270043373108, -1.6019115447998047, -1.5422594547271729, -0.26837268471717834, -1.0594700574874878, -1.7739094495773315], [-0.398430734872818, 1.0732274055480957, -1.3770229816436768, -0.6845036745071411, 0.7048077583312988, -2.234358310699463, 1.8881504535675049, -0.33293473720550537, 3.0147624015808105, 0.19990605115890503, -0.4215734004974365, -0.9246740937232971, -1.8692293167114258, -0.7289865016937256, 1.518053412437439, -1.7225006818771362], [0.5087490677833557, -0.27192652225494385, -0.5404969453811646, 0.12042433023452759, -0.5628848075866699, 1.1719857454299927, -0.07389097660779953, -0.9998555183410645, -1.8671907186508179, 0.7057558298110962, 0.9212816953659058, -2.0275697708129883, -0.983529269695282, -1.0170090198516846, 0.5701295137405396, -1.6484602689743042], [-1.0813016891479492, 1.8321754932403564, -1.1518560647964478, -1.567870855331421, 2.8022360801696777, -0.6278398036956787, -1.933232069015503, -2.028719902038574, 0.3994002640247345, -0.31433019042015076, -1.6483817100524902, -0.2417345643043518, 0.3052675127983093, 0.989896297454834, -0.1778598129749298, 1.5500245094299316], [2.0347015857696533, -0.280759334564209, -0.7172321081161499, -3.697732925415039, 0.8875159621238708, 0.4868937134742737, 0.26461535692214966, -1.9957009553909302, 0.6421357989311218, -0.6392039060592651, -1.682052493095398, -1.2370362281799316, -0.2352406084537506, 0.8327987790107727, 2.0572502613067627, 0.6041803956031799], [1.6654763221740723, 1.3821427822113037, 1.4638192653656006, 0.2219933271408081, 0.9098039865493774, 0.2657618224620819, -0.6461665630340576, -1.2348071336746216, 1.6244637966156006, -1.9784942865371704, 2.712327480316162, -0.3420243561267853, -0.705276370048523, 0.42920705676078796, -0.5940912961959839, 0.9308212995529175]], target: [1, 1, 1, 1, 0, 0, 0, 0, 1, 1]
[[split=train]] train_iter: 0, batch_idx: 1, input: [[-0.9896684885025024, -0.6932245492935181, 0.8167281746864319, -0.3794645667076111, 1.604407787322998, 1.5360808372497559, 0.12697190046310425, -0.19879382848739624, 0.3979586660861969, 1.227940320968628, -0.45777490735054016, -1.0740365982055664, 1.2347297668457031, -2.2588515281677246, -0.9572713375091553, 1.8971928358078003], [-0.7473424673080444, 0.3085596561431885, -0.20496073365211487, 2.627124786376953, 0.6806991100311279, 0.48170673847198486, 0.8647680282592773, 0.39877766370773315, -3.005899429321289, 0.4621919095516205, 1.0710079669952393, -0.6646972298622131, -0.2837066650390625, -0.1620563268661499, -2.3196611404418945, 0.8059489727020264], [1.713578224182129, -0.719067394733429, 0.22874003648757935, -0.9708988666534424, -1.16658353805542, 1.7109938859939575, -0.5786951184272766, 1.4733234643936157, -2.0360875129699707, -0.09253019094467163, -0.6641320586204529, -0.4397808313369751, -0.8447830677032471, -0.17934072017669678, 1.0523457527160645, 1.399848461151123], [-2.0035367012023926, 0.4161122441291809, 0.42962563037872314, -0.34848594665527344, 1.3255425691604614, -1.2161095142364502, -0.8588804006576538, 0.4630114436149597, -2.4216175079345703, 0.7369401454925537, 2.1926164627075195, -1.0410088300704956, 0.6149548888206482, 1.125978708267212, -0.385662317276001, -1.0088138580322266], [-0.873416543006897, 0.08027362823486328, 1.2197089195251465, 3.052464485168457, 2.247830390930176, 0.24901926517486572, -1.6914647817611694, -1.090437412261963, 1.017340064048767, 0.8769302368164062, -0.270926833152771, -2.290555000305176, 0.5310970544815063, -0.6010401248931885, 0.5470483899116516, 0.3770822286605835], [-1.560192346572876, 0.7982132434844971, -1.1141607761383057, 2.2048048973083496, 0.9395177364349365, -0.037937015295028687, -0.9633914232254028, -1.8001097440719604, -1.186493158340454, 1.1125104427337646, -0.8563224077224731, -0.0827631950378418, -0.9924063086509705, 0.8097198009490967, -0.28567397594451904, -1.4113993644714355], [1.259131669998169, 0.11520802974700928, 0.11127060651779175, 3.254042148590088, 0.7239338755607605, -2.3754067420959473, 1.502967119216919, -1.341651439666748, -0.9947545528411865, 1.870601773262024, 0.8517523407936096, 0.5804382562637329, 0.3368878662586212, -0.21043336391448975, 1.0107463598251343, -0.39931970834732056], [-1.0976922512054443, 0.17144495248794556, -0.471584290266037, 0.817023754119873, 1.68056058883667, 0.5129784345626831, -0.360016405582428, -0.5025659799575806, -1.857862949371338, 0.21086552739143372, 0.720137894153595, -0.37965238094329834, -0.3162167966365814, -0.15631455183029175, -0.04258465766906738, -1.3113200664520264], [-1.6417524814605713, 1.2094184160232544, -0.635334849357605, 2.3297367095947266, 0.3398226499557495, 0.9272831678390503, -0.1502731591463089, 1.107344150543213, -1.8310391902923584, 1.0988097190856934, 0.7257629036903381, -1.7842512130737305, -0.11477945744991302, 2.8324828147888184, -0.45651721954345703, -0.9674422740936279], [-2.561161756515503, -0.39031165838241577, -0.6431606411933899, 0.3972717523574829, 0.9543094635009766, 1.5387887954711914, -0.5350375175476074, -0.12673741579055786, -1.0624514818191528, -0.6960238218307495, -0.12862873077392578, 0.31113147735595703, -1.7579834461212158, 1.5968679189682007, 1.3148081302642822, -0.2465447187423706]], target: [1, 0, 1, 0, 1, 0, 0, 0, 0, 0]

  1%|          | 10/1000 [00:02<03:02,  5.42it/s]
[[split=eval]] train_iter: 0, eval_iter: 1, batch_idx: 0, input: [[1.6824767589569092, -0.12416306138038635, -0.39783143997192383, -0.9760239720344543, -0.15463939309120178, 2.1428475379943848, 1.1680240631103516, 1.3513710498809814, -0.1208442896604538, 1.5621721744537354, -0.13981181383132935, 0.35819166898727417, -1.1022169589996338, -0.6262861490249634, 1.307867169380188, -0.7538597583770752], [-0.4396413564682007, -0.13088947534561157, 2.279472827911377, 0.7285913228988647, -0.18801945447921753, 0.5439978241920471, 1.8616772890090942, -1.6721305847167969, -0.5496948957443237, -2.0170722007751465, 1.2243692874908447, 1.166947364807129, -1.2834309339523315, 1.3606278896331787, 0.004647254943847656, 0.8151227235794067], [-0.6282798647880554, -0.9466968178749084, -0.19374972581863403, 0.21524173021316528, -1.2082502841949463, 0.24866101145744324, -0.20498740673065186, -1.485066533088684, 0.6492854356765747, -0.354356586933136, -0.9295142889022827, 1.1462827920913696, 1.2443429231643677, 0.5073676109313965, 0.8979353904724121, 0.6268912553787231], [-1.190969467163086, -0.2856691777706146, 0.40201902389526367, -0.17508918046951294, 0.7688766717910767, -0.040345922112464905, -0.29841434955596924, -0.04809737205505371, 0.6213723421096802, 3.17270565032959, -0.46021556854248047, 1.1313927173614502, 0.9002565145492554, -0.8586390614509583, 1.4293572902679443, -0.6907442212104797], [-0.4833407402038574, -1.3059442043304443, -0.8889410495758057, -0.7153687477111816, 1.4219502210617065, -0.02365995943546295, -0.23268556594848633, 0.6895418763160706, -0.016207978129386902, 2.1645240783691406, 0.3754291236400604, 0.9294005632400513, 1.666422963142395, -1.2401286363601685, -0.30211302638053894, 0.7862509489059448], [0.05384527146816254, -1.2888144254684448, -0.17001231014728546, -1.33046293258667, -0.9807424545288086, 1.2584822177886963, -0.35376083850860596, 0.5468395352363586, -0.7697172164916992, 0.662036657333374, 2.1297590732574463, 0.45774102210998535, 1.7900904417037964, -0.8989505171775818, -0.20030628144741058, 0.1804753541946411], [-0.665522575378418, 2.247537136077881, 1.7118176221847534, 0.04235875606536865, -0.02132245898246765, 1.3925786018371582, -1.0391358137130737, -0.8686542510986328, -1.420846700668335, -0.5593845844268799, -0.3209126591682434, 1.1964056491851807, 0.36330533027648926, 0.718058705329895, 2.4453392028808594, 0.4590986371040344], [-1.4135910272598267, 0.17099326848983765, 2.519775152206421, -0.6016767024993896, -0.8035529851913452, -0.06561821699142456, -1.2507655620574951, -1.539149284362793, -0.6375802159309387, -0.34569960832595825, 1.013785481452942, 1.9759315252304077, -2.1224770545959473, -0.4506261348724365, 0.4761744737625122, 1.9395430088043213], [0.5925204157829285, -2.144406795501709, -0.599504828453064, 0.39349526166915894, -0.17187631130218506, 1.3166354894638062, -0.2339237928390503, -1.608883023262024, 0.7071664333343506, -0.42633509635925293, -0.7036190032958984, 0.36698317527770996, 1.2134020328521729, 1.199072241783142, -0.5205054879188538, -2.699526786804199], [0.683349072933197, 0.5220487117767334, 1.8973203897476196, -1.4434540271759033, 1.2910761833190918, 0.5457519888877869, -0.5402352213859558, -1.8815747499465942, 0.08863699436187744, -0.44318655133247375, -2.0760345458984375, -1.4156997203826904, 0.9976913928985596, 0.4235273003578186, 0.7454603314399719, 0.21489526331424713]], target: [1, 0, 1, 1, 1, 1, 0, 0, 1, 0]

















































































100%|██████████| 1000/1000 [02:47<00:00,  5.45it/s]
[[split=test]] train_iter: 0, eval_iter: 0, batch_idx: 0, input: [[-0.43552887439727783, 0.007368683815002441, 0.9478849172592163, -0.31263870000839233, -0.9897385835647583, -1.205442190170288, -0.7513461709022522, 1.103174090385437, 0.9361937046051025, -0.8696761727333069, -1.630163550376892, 1.9312785863876343, -0.20641553401947021, 0.18888181447982788, 1.0874388217926025, -0.1385347843170166], [-1.9605149030685425, 1.172332525253296, -1.4269548654556274, 0.19389784336090088, -3.175872802734375, -0.4173201024532318, 0.642121434211731, 1.5882281064987183, -0.34346675872802734, 0.9081318378448486, -0.0165480375289917, -0.9770034551620483, -1.701245903968811, -0.8829474449157715, 1.257362723350525, -1.7227863073349], [-1.088587760925293, -0.5580098628997803, 0.31924283504486084, 0.6274278163909912, 0.36994147300720215, -0.1033543050289154, -0.7732261419296265, -1.2422997951507568, -1.3892855644226074, -0.19667208194732666, 1.583243489265442, -0.27038583159446716, 1.145339012145996, 0.6084104776382446, -0.17359846830368042, -1.9872781038284302], [0.8624252080917358, 1.3701879978179932, -0.695002555847168, -0.9853690266609192, 0.10474914312362671, -1.6088947057724, 1.5651723146438599, 0.42931580543518066, -0.5416683554649353, -1.3649365901947021, -1.1327390670776367, -1.5075445175170898, -0.6070929169654846, -0.23605066537857056, -1.9595997333526611, -0.7422559857368469], [-0.9177008867263794, 0.6220269203186035, -0.9179106950759888, -0.8134156465530396, 0.32924723625183105, 0.15889114141464233, 1.3348692655563354, 2.931715965270996, -0.8676770329475403, -0.5756317377090454, 0.9961751699447632, 1.7585725784301758, -0.4013129770755768, 0.9719115495681763, 1.2936747074127197, 0.08600002527236938], [0.427041620016098, 0.3051919639110565, 0.6010592579841614, -1.5049166679382324, -0.8444578647613525, -0.5143827199935913, -0.6336992979049683, -0.09216731786727905, -1.1288847923278809, 0.14662182331085205, -1.0004985332489014, 0.3356902599334717, -0.5815561413764954, 0.983244001865387, 0.31037652492523193, 0.3704404830932617], [-0.42014142870903015, 0.4509637653827667, -0.08800512552261353, -0.5808945894241333, 0.8874462842941284, 0.5023048520088196, -0.4323524236679077, -0.7298206090927124, -0.06657430529594421, -0.3409428596496582, 0.7041586637496948, 0.8434913158416748, 0.9523489475250244, -1.346022129058838, 0.44869881868362427, -0.7485777139663696], [-0.6954530477523804, 0.6675150394439697, -0.1355365812778473, -0.9034574627876282, -1.0502365827560425, -0.9277742505073547, 0.4150370955467224, 0.5212050676345825, 0.11565180122852325, 0.270282506942749, -1.115786075592041, 0.11528551578521729, -1.3709862232208252, -0.6924203038215637, -0.5693349838256836, 1.627614140510559], [-0.8549790978431702, -0.08155268430709839, -1.1403653621673584, -1.7340024709701538, -1.1313362121582031, -0.6353355050086975, 0.2696617841720581, -1.2190303802490234, -0.730815589427948, 1.597952127456665, -2.7989354133605957, 2.0146875381469727, -0.8760677576065063, -0.8845603466033936, 0.7824171781539917, 2.9127044677734375], [-1.8245595693588257, 1.4447064399719238, 0.7922065258026123, 0.7023812532424927, -0.9940148591995239, 0.929895281791687, -0.19951513409614563, 1.1609070301055908, 0.8955879211425781, -1.3602713346481323, 0.23615765571594238, 0.828216552734375, -1.0216871500015259, -0.09650030732154846, -0.6681953072547913, -0.114205002784729]], target: [1, 1, 0, 0, 1, 0, 1, 1, 1, 1]
[[split=test]] train_iter: 0, eval_iter: 1, batch_idx: 0, input: [[-0.26311856508255005, -0.6352155208587646, -1.8593170642852783, 0.32208868861198425, -2.038996696472168, 1.483115553855896, -1.4325687885284424, -1.7800931930541992, 1.246152400970459, 2.4502811431884766, -1.8336256742477417, 0.4829447865486145, -0.25074565410614014, -0.0015506744384765625, -0.5558445453643799, 1.0595182180404663], [0.6725586652755737, 2.050004482269287, -0.020173370838165283, 2.6388492584228516, -0.5718518495559692, -0.2773376703262329, 0.6063598394393921, 0.31861740350723267, 1.6208059787750244, -0.7709699869155884, -0.6688573956489563, 0.24722307920455933, 0.15272018313407898, 0.7023391723632812, 1.2375144958496094, -0.8757522106170654], [0.38346758484840393, -1.1984336376190186, -1.418793797492981, -0.04678606986999512, 0.06218576431274414, 2.294113874435425, -1.1424543857574463, -0.5426938533782959, 1.0006988048553467, 0.8490380644798279, -1.2326619625091553, 0.7322991490364075, -2.2738921642303467, 0.7123642563819885, -1.7579095363616943, 0.6611475348472595], [0.4366428256034851, -1.227381706237793, 0.04836156964302063, 1.213301181793213, 0.15641427040100098, 2.398388385772705, -1.368322491645813, -0.8879849910736084, 1.0200903415679932, -0.09039062261581421, -0.771172285079956, 0.5231250524520874, 1.8368003368377686, 2.249861478805542, -0.3117580711841583, -0.2783602178096771], [1.593523621559143, 0.02422061562538147, -0.13402163982391357, 0.8771019577980042, -1.1241998672485352, 1.7539727687835693, -0.5770383477210999, -0.4460500478744507, 0.22332069277763367, 3.418394088745117, -2.084519863128662, -0.6213685274124146, 1.366809606552124, 1.4436912536621094, 0.5082447528839111, 0.49785757064819336], [-0.8165549039840698, -0.22026300430297852, 0.43461087346076965, 0.022484123706817627, -0.669823169708252, 0.861205518245697, 1.022859811782837, -1.0247199535369873, 1.2558598518371582, 1.8680140972137451, -1.2248998880386353, 1.6091790199279785, 0.43018269538879395, -0.8221646547317505, -0.4773848354816437, 0.3196038007736206], [-1.3014888763427734, -0.4965435266494751, -0.6340649724006653, 0.3794001042842865, -2.314821481704712, 0.5391412973403931, -2.4554781913757324, 0.3009626865386963, 1.0698634386062622, 1.09305739402771, -0.5161938667297363, -0.9118461608886719, 0.40389329195022583, -0.5844911336898804, -0.26492181420326233, -1.7607131004333496], [-0.16408860683441162, -0.19714321196079254, 0.06494560837745667, 2.6343584060668945, -0.9751589298248291, 0.48942482471466064, -2.1162681579589844, 0.06738007068634033, 2.7725586891174316, -0.6346601247787476, -0.24589908123016357, 0.7154214978218079, -0.6883647441864014, 0.10590791702270508, 0.460615873336792, 0.07945382595062256], [-0.5608759522438049, -0.5007471442222595, -0.6266610622406006, 0.4968928396701813, 1.2679792642593384, 0.17239195108413696, 0.8484275341033936, -0.1715908646583557, 2.4061989784240723, -0.07436341047286987, -1.3849855661392212, 1.117548942565918, 1.1185400485992432, 1.1381075382232666, -1.3888969421386719, -0.42746996879577637], [0.04446670413017273, 0.412151038646698, -0.021945416927337646, 0.26121824979782104, 0.9677748084068298, -0.2259381115436554, 0.36096638441085815, -0.5736010670661926, 0.16705965995788574, 1.3152897357940674, -1.4630028009414673, -0.7056546211242676, -1.9292734861373901, 1.11025869846344, -0.39111050963401794, 0.37992414832115173]], target: [1, 0, 1, 1, 1, 1, 1, 1, 0, 0]





























