[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'seed' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'optimizer' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'model' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'data' was locked by 'sweep' (ignored update).
  0%|                                                                                  | 0/100001 [00:00<?, ?it/s]
CONFIG
â”œâ”€â”€ seed
â”‚   â””â”€â”€ 9656
â”œâ”€â”€ seed_eval
â”‚   â””â”€â”€ 2000
â”œâ”€â”€ seed_test
â”‚   â””â”€â”€ 3000
â”œâ”€â”€ device
â”‚   â””â”€â”€ cuda
â”œâ”€â”€ train
â”‚   â””â”€â”€ do: true
â”‚       do_save: false
â”‚       reset_every: null
â”‚       dtype: float32
â”‚       compile: false
â”‚       do_amp: false
â”‚       batch_size: 128
â”‚       grad_clip: 1.0
â”‚       iters: 100001
â”‚       samples: null
â”‚       log_every: 1000
â”‚       save_every: 100000
â”‚       save_path: ./out
â”‚       num_workers: 0
â”‚       do_early_stop: false
â”‚       early_stop_patience: 5
â”‚       early_stop_metric: loss
â”‚       early_stop_tol: 0.001
â”‚       early_stop_start_iter: 20000.2
â”‚       early_stop_acc: null
â”‚       parallel_loss: true
â”‚       merge_embeds: false
â”‚       merge_type: sum
â”‚
â”œâ”€â”€ eval
â”‚   â””â”€â”€ do: true
â”‚       split: both
â”‚       batch_size: 1
â”‚       every: 5000
â”‚       every_samples: null
â”‚       iters: 1000
â”‚
â”œâ”€â”€ scheduler
â”‚   â””â”€â”€ decay_lr: true
â”‚       warmup_iters: 20000.2
â”‚       lr_decay_iters: 100001
â”‚       min_lr: 0.0001
â”‚
â”œâ”€â”€ optimizer
â”‚   â””â”€â”€ lr: 0.001
â”‚       _name_: adamw
â”‚       weight_decay: 0
â”‚       betas:
â”‚       - 0.9
â”‚       - 0.95
â”‚
â”œâ”€â”€ log_level
â”‚   â””â”€â”€ info
â”œâ”€â”€ examples_to_log
â”‚   â””â”€â”€ 3
â”œâ”€â”€ log_batch_idx
â”‚   â””â”€â”€ [0, 1]
â”œâ”€â”€ wandb
â”‚   â””â”€â”€ project: icl-arch
â”‚
â”œâ”€â”€ save_checkpoints
â”‚   â””â”€â”€ False
â”œâ”€â”€ nl_icl
â”‚   â””â”€â”€ do: false
â”‚       checkpoint_path: null
â”‚       hf_path: null
â”‚       task: sentiment
â”‚       n_seeds: 10
â”‚       min_examples_per_class: 0
â”‚       max_examples_per_class: 9
â”‚       do_full_vocab: true
â”‚
â”œâ”€â”€ do_count_param_only
â”‚   â””â”€â”€ False
â”œâ”€â”€ model
â”‚   â””â”€â”€ _name_: rnn
â”‚       d_model: 64
â”‚       n_layer: 12
â”‚       activ_fn: tanh
â”‚       bias: false
â”‚       batch_first: true
â”‚       dropout: 0.0
â”‚       bidirectional: false
â”‚       max_seq_len: 4096
â”‚
â””â”€â”€ data
    â””â”€â”€ _name_: gauss-mix-model
        num_classes: 2
        num_xy_pairs_train: 32
        num_xy_pairs_val: 1024
        dim: 16
head.linear.weight: 128
head.linear.bias: 2
rnn.weight_ih_l0: 4096
rnn.weight_hh_l0: 4096
rnn.weight_ih_l1: 4096
rnn.weight_hh_l1: 4096
rnn.weight_ih_l2: 4096
rnn.weight_hh_l2: 4096
rnn.weight_ih_l3: 4096
rnn.weight_hh_l3: 4096
rnn.weight_ih_l4: 4096
rnn.weight_hh_l4: 4096
rnn.weight_ih_l5: 4096
rnn.weight_hh_l5: 4096
rnn.weight_ih_l6: 4096
rnn.weight_hh_l6: 4096
rnn.weight_ih_l7: 4096
rnn.weight_hh_l7: 4096
rnn.weight_ih_l8: 4096
rnn.weight_hh_l8: 4096
rnn.weight_ih_l9: 4096
rnn.weight_hh_l9: 4096
rnn.weight_ih_l10: 4096
rnn.weight_hh_l10: 4096
rnn.weight_ih_l11: 4096
rnn.weight_hh_l11: 4096
n_params=98434
ignored=[('embedder.embedder.weight', 1024), ('embedder.embedder.bias', 64), ('embedder.y_embedder.weight', 32)]
Error executing job with overrides: ['data=gauss-mix-model', 'data.dim=16', 'data.num_classes=2', 'data.num_xy_pairs_train=32', 'data.num_xy_pairs_val=1024', 'eval.every=5000', 'eval.iters=1000', 'model=rnn', 'model.d_model=64', 'model.max_seq_len=4096', 'model.n_layer=12', 'optimizer=adamw', 'optimizer.lr=0.001', 'optimizer.weight_decay=0', 'scheduler.decay_lr=True', 'seed=9656', 'train.batch_size=128', 'train.do_early_stop=False', 'train.iters=100001', 'train.log_every=1000', 'train.parallel_loss=True']
[[split=train]] train_iter: 0, batch_idx: 0, input: [[0.5010024309158325, -0.5577409267425537, -1.5520334243774414, 0.610539436340332, -1.3670426607131958, -2.784710645675659, -0.5616137981414795, 0.3666508197784424, 0.12928107380867004, -1.3705476522445679, -1.8601367473602295, -1.2199106216430664, 0.354202538728714, -1.1076221466064453, -0.5890680551528931, 0.24287667870521545], [1.2226953506469727, -0.6639295220375061, -0.8094595670700073, 0.7670587301254272, 0.6354303359985352, 1.062276840209961, 0.5573395490646362, 0.7579469680786133, -0.3822225332260132, 0.2840591371059418, 1.8375234603881836, 0.7300276160240173, 0.9121782779693604, -1.1484475135803223, 1.3708983659744263, 1.4605216979980469], [-0.5126247406005859, 0.8043564558029175, -0.6611353158950806, 0.11943572759628296, 2.323505163192749, -1.1963027715682983, -0.5157456398010254, -1.0159687995910645, -0.5031476020812988, -1.594828486442566, -2.2069740295410156, 0.4670923948287964, -1.1157503128051758, -1.2701812982559204, -0.4721926748752594, 0.5823720693588257], [1.9379494190216064, -0.16887450218200684, -0.4775867462158203, 1.3121531009674072, 2.664466381072998, -1.1110179424285889, -0.635029673576355, -0.8335767388343811, -1.4048540592193604, -0.6723675727844238, -0.3583575487136841, 0.3162859380245209, -0.12182697653770447, -1.9655715227127075, 1.283105492591858, 1.4809458255767822], [-0.32691454887390137, 0.2953912615776062, 0.30619877576828003, -0.01578681170940399, -2.8187432289123535, 0.30740416049957275, -0.009449958801269531, -1.3625239133834839, 0.6987757682800293, -0.8017358779907227, 1.0286502838134766, -0.10210567712783813, -0.5612223148345947, -0.9343671202659607, 0.14496266841888428, 1.971793532371521], [0.10629725456237793, -0.2784308195114136, 1.7863489389419556, 0.29404741525650024, 0.1334630250930786, 0.045046329498291016, 0.1954384446144104, -1.1895737648010254, 0.08689796924591064, 0.6691683530807495, 0.5919250845909119, 1.2148759365081787, -0.557432234287262, -2.301738739013672, 0.690904438495636, -0.0014720559120178223], [2.9692702293395996, -2.524587631225586, -0.1605457067489624, 1.466937780380249, 1.7106086015701294, 0.5017834305763245, -1.4753565788269043, 1.1523548364639282, -1.1561336517333984, -0.6542593240737915, -1.867894172668457, -0.16464537382125854, 1.0904877185821533, -1.3723938465118408, 0.5007338523864746, 0.8627830743789673], [1.4151806831359863, 0.2546429932117462, 0.28929197788238525, -0.08499693870544434, -0.4579846262931824, -0.17212575674057007, 0.7787580490112305, -0.9898378252983093, 1.2781821489334106, 1.332839012145996, -0.17440597712993622, -0.6102101802825928, 1.3270859718322754, -1.2104666233062744, 0.5740898251533508, -0.34324049949645996], [0.2160469889640808, -1.9381544589996338, 0.22133898735046387, -0.5230748653411865, 0.8218291997909546, -0.1579427719116211, -1.476755142211914, -0.16403228044509888, -0.04573100805282593, -0.45500561594963074, -2.438300132751465, 1.0116808414459229, -0.3142947554588318, -1.5000600814819336, -1.5375548601150513, 1.7736060619354248], [1.2065465450286865, 0.265344500541687, -1.8397048711776733, -1.0652031898498535, 1.4449000358581543, 1.1424267292022705, -0.14466118812561035, -0.2519146502017975, -0.2863650918006897, -0.08231338858604431, -0.3170967698097229, 1.3372833728790283, 0.7930780053138733, -0.5297113656997681, 1.2364039421081543, 1.0062761306762695]], target: [1, 0, 1, 1, 0, 0, 1, 0, 1, 0]
[[split=train]] train_iter: 0, batch_idx: 1, input: [[2.3212008476257324, -0.13159707188606262, 0.16686320304870605, -1.0624881982803345, 0.9499529600143433, -1.1113357543945312, 0.7575057744979858, -1.4657357931137085, -0.987653374671936, 0.7690917253494263, -0.3791736662387848, 2.111703872680664, -0.42856478691101074, 0.7530421614646912, -0.32400962710380554, -0.07895129919052124], [0.8430216908454895, 1.2524592876434326, 1.117607831954956, -0.4558969736099243, -0.6023586988449097, 1.5221871137619019, 0.06974107027053833, -0.37715357542037964, 1.6334867477416992, -1.5573683977127075, 0.11993378400802612, -0.8509557843208313, 1.9459736347198486, 0.26228538155555725, -0.7155098915100098, 0.48761874437332153], [0.41641372442245483, 1.1190038919448853, 2.7428383827209473, 0.9950417280197144, 0.720751166343689, -1.2115570306777954, -0.1020466685295105, 1.3947486877441406e-05, 0.8885141015052795, -0.9944039583206177, -0.17161518335342407, 1.600454330444336, 0.5679349899291992, 0.6367323994636536, -0.7134361863136292, 0.0495031476020813], [-0.8471099138259888, 0.3319846987724304, 0.9910646677017212, -0.6709916591644287, 0.6183550953865051, 1.6130175590515137, -0.9460605382919312, -0.8010178804397583, -0.9538332223892212, 1.0821661949157715, 0.5765886306762695, 1.921579360961914, 3.0486133098602295, 2.3448386192321777, -1.329003095626831, 0.6089446544647217], [1.834547519683838, -0.7840076684951782, -0.4584115743637085, 1.707236409187317, 1.8010963201522827, -0.3951338827610016, 0.1797890067100525, -0.07684563100337982, -0.3476378917694092, -0.49963051080703735, 0.007475227117538452, -0.23694837093353271, -0.7080167531967163, -2.667661190032959, 1.509108066558838, -1.2442760467529297], [1.0926659107208252, -0.2249542474746704, 1.3466721773147583, -2.3279659748077393, -1.4583110809326172, 0.5894801616668701, -0.7966309785842896, -0.2127319574356079, -1.5067058801651, 1.6797925233840942, -1.2142479419708252, -0.02537253499031067, -1.7200133800506592, 0.5360908508300781, -1.0768977403640747, -0.049982428550720215], [0.7234740257263184, 0.37249428033828735, -0.8356862664222717, 0.3634129762649536, 0.3591573238372803, -1.8256922960281372, -0.4014894962310791, -0.3700440227985382, -1.9261279106140137, 0.39702266454696655, -0.8143044710159302, 1.3820080757141113, 0.07196901738643646, -0.7582336664199829, -1.8526896238327026, 1.3554702997207642], [1.531412124633789, 0.12499317526817322, -1.445676326751709, 0.575206995010376, 1.1162075996398926, -0.922276496887207, 1.2241110801696777, -0.04524078220129013, 1.2361998558044434, -0.20373758673667908, -1.164680004119873, 2.5167055130004883, -0.19941328465938568, 0.15649819374084473, -0.13296306133270264, 0.10712116956710815], [2.17086124420166, -0.8499568700790405, -1.8506265878677368, 0.05688369274139404, 0.9882473945617676, -1.790763020515442, 1.2844057083129883, -0.8361125588417053, -0.6044117212295532, -1.1419719457626343, -0.18634352087974548, 1.4118531942367554, 0.20406514406204224, 1.8300645351409912, -0.9560317993164062, 0.32915520668029785], [-0.17879563570022583, 0.018847256898880005, 2.751582622528076, 0.8511708974838257, 1.1366994380950928, -0.3921447992324829, -0.6258581876754761, 0.7867220640182495, 1.3366155624389648, -0.7363662719726562, -0.2114768624305725, -0.24430611729621887, 2.6127421855926514, 0.7814356088638306, -0.6805750131607056, -1.0903451442718506]], target: [0, 0, 0, 0, 1, 0, 1, 1, 1, 0]
[[split=eval]] train_iter: 0, eval_iter: 0, batch_idx: 0, input: [[2.344269275665283, -2.5244593620300293, -0.5285239815711975, -0.06986922025680542, 2.388084888458252, -1.3630146980285645, -0.5205078125, 0.3163345754146576, 0.3181386888027191, -0.7090381979942322, -0.05098959803581238, 1.0630791187286377, 1.498608112335205, 1.2403860092163086, -2.270857572555542, 1.1733758449554443], [-0.5911123752593994, -3.1180520057678223, -2.242882013320923, 1.5368261337280273, 2.6728744506835938, 1.1043565273284912, 0.15248194336891174, 1.138047218322754, 2.6381163597106934, 0.5661758184432983, 0.779382586479187, 0.45325466990470886, -0.3230854272842407, 0.5923430323600769, -1.1465858221054077, 0.5992897748947144], [-2.5623531341552734, -2.200399875640869, 0.18073858320713043, -2.224458932876587, 0.1495760679244995, -0.37950068712234497, -1.5245177745819092, -1.2582390308380127, -1.14261794090271, -2.633575677871704, -2.0780506134033203, 0.3941320776939392, -0.6134988069534302, 0.5944231748580933, -0.8933064937591553, 0.21462303400039673], [-1.430187702178955, -0.2657005190849304, -0.74467933177948, -0.20488327741622925, -1.5934183597564697, 0.29538512229919434, -0.46825677156448364, 0.10826754570007324, 0.6208192110061646, 1.7970268726348877, -1.2511200904846191, 1.0218764543533325, -0.15230272710323334, 1.4594542980194092, 1.1701469421386719, 0.7878883481025696], [-0.5103492736816406, -0.3688650131225586, 1.2720450162887573, -0.3391262888908386, 0.20164132118225098, -0.5797208547592163, -0.5413231253623962, 0.780439555644989, -0.7621029615402222, -0.33513858914375305, -1.3069615364074707, 0.6934620141983032, 0.8385039567947388, 0.15723872184753418, 0.5643194913864136, -0.23543506860733032], [-1.8201674222946167, 0.21691668033599854, -0.9638412594795227, -0.4855309724807739, 1.6546283960342407, -0.6425611972808838, 1.2752289772033691, 0.5786818265914917, 0.06374084949493408, 1.5023077726364136, 0.7123967409133911, 2.635810613632202, 1.7875323295593262, -0.4001118540763855, -1.074651837348938, 0.13472259044647217], [-0.7884153723716736, -1.8069133758544922, -0.13843418657779694, -1.262953758239746, -2.7691545486450195, 0.636591911315918, 0.2734014391899109, -0.020524322986602783, 0.3220105767250061, -2.6284186840057373, -1.0969595909118652, -0.4671468734741211, 0.6045739650726318, 1.273727297782898, 1.0608935356140137, 0.6181715726852417], [-0.3597904443740845, 0.09398312866687775, -2.102694034576416, -0.14040258526802063, 2.0944066047668457, -1.4746536016464233, -1.9096637964248657, 0.6091864109039307, -0.4004676342010498, 0.3207226097583771, -0.4795788526535034, -1.0610564947128296, 0.5095633268356323, -0.6003806591033936, 0.06969684362411499, 1.2932671308517456], [-1.792353630065918, -0.23157238960266113, 1.2360224723815918, -0.07203495502471924, -1.4886974096298218, 0.15047019720077515, 1.0012127161026, 2.1566195487976074, -0.09333106875419617, 1.292629361152649, -0.9131580591201782, 1.016747236251831, 2.05734920501709, 1.2580958604812622, -0.06297984719276428, -0.0620884895324707], [-1.068619966506958, -0.06572140008211136, -1.5891306400299072, -0.5966821312904358, 0.42807361483573914, -0.35724958777427673, -0.9725099802017212, 1.5081228017807007, 0.4873749613761902, -1.7534593343734741, 2.7191262245178223, 1.0298497676849365, -0.575126051902771, 2.8500614166259766, 0.576712965965271, 1.1918644905090332]], target: [1, 1, 0, 0, 0, 1, 0, 1, 0, 1]
Traceback (most recent call last):
  File "/mnt/ceph_rbd/synth-icl/main.py", line 1690, in <module>
    main()
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/mnt/ceph_rbd/synth-icl/main.py", line 1679, in main
    train(
  File "/mnt/ceph_rbd/synth-icl/main.py", line 1314, in train
    train_iter, exit_training, best_eval_loss, best_eval_acc = train_loop(
  File "/mnt/ceph_rbd/synth-icl/main.py", line 936, in train_loop
    eval_log = evaluate(
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/mnt/ceph_rbd/synth-icl/main.py", line 1395, in evaluate
    hidden_states = model(embeddings)  # [batch_size, seq_len, emb_dim]
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ceph_rbd/synth-icl/arch/rnn.py", line 35, in forward
    output, _ = self.rnn(x)  # [batch_size, seq_len, hidden_dim]
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/anaconda3/envs/icl/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 509, in forward
    result = _VF.rnn_tanh(input, hx, self._flat_weights, self.bias, self.num_layers,
RuntimeError: Input and parameter tensors are not the same dtype, found input tensor with Half and parameter tensor with Float